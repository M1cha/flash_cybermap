<?xml version="1.0" encoding="utf-8"?>
<!--
  CyberMap
  Copyright 2015 CyberTeam All rights reserved.

  CyberMap is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  CyberMap is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with CyberMap. If not, see <http://www.gnu.org/licenses/>.
-->

<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:material="org.github.material.*" minWidth="800" minHeight="600"
			   xmlns:umap="com.umapper.flex.umap.*" xmlns:styles="com.umapper.umap.styles.*">
	<s:layout>
		<s:BasicLayout/>
	</s:layout>
	
	<fx:Declarations>
		<fx:int id="animDuration">170</fx:int>
		<fx:int id="navDrawerHiddenPosition">{-(navigationDrawer.width + 8)}</fx:int>

		<!-- toolbar dropshadow -->
		<s:DropShadowFilter id="dropShadow1" quality="1" color="#000000" alpha="0.8" distance="0" blurX="{MaterialUtils.dp2px(8)}" blurY="{MaterialUtils.dp2px(8)}" strength="1" />

	</fx:Declarations>

	<fx:Script>
		<![CDATA[
			import org.cyberteam.cybermap.gpx.GPX;
			import org.cyberteam.cybermap.gpx.GPXLoader;
			import org.github.material.*;
			
			private function onGPXLoaded(gpx:GPX):void {
				var item:org.github.material.TwoLineListItem = new org.github.material.TwoLineListItem();
				item.label=gpx.name;
				item.labelSecondary = gpx.distance.toFixed(1) + " km"
				gpxlist.addElement(item);
			}

			// setup material settings
			MaterialUtils.primaryColor = 0xff9800;
		]]>
	</fx:Script>

	<!-- map -->
	<umap:UMapComponent id="map" width="100%" height="100%"/>
	
	<!-- toolbar -->
	<material:Toolbar id="toolbar" title="CyberMap">
		<!-- navigation button -->
		<s:Button buttonMode="true" skinClass="org.github.material.skins.NavigationButton" click="navigationDrawer.fadeIn()" />
	</material:Toolbar>
	
	<!-- navigation drawer -->
	<material:NavigationDrawer id="navigationDrawer">
		<material:Button cornerRadius="0" nomargin="true" height="{MaterialUtils.dp2px(36)}" label="Upload" width="100%" buttonColor="#ffffff" color="{MaterialUtils.primaryColor}" click="GPXLoader.fromFileDialog(onGPXLoaded)" />
		<mx:HRule width="100%" strokeWidth="1" strokeColor="#DDDDDD" />
		<s:Scroller id="scroller" focusEnabled="false" height="100%" width="100%"
					hasFocusableChildren="true"
					horizontalCenter="0" verticalCenter="0" horizontalScrollPolicy="off">
			<s:VGroup id="gpxlist" width="100%" gap="0" />
		</s:Scroller>
	</material:NavigationDrawer>

</s:Application>
